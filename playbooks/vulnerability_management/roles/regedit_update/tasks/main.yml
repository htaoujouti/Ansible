- name: add security layer
  ansible.windows.win_regedit:
    path: "{{SecurityLayer}}"
    name: SecurityLayer
    data: 2
    type: dword        

- name: add Min Encryption Level 1
  ansible.windows.win_regedit:
    path: "{{SecurityLayer}}"
    name: MinEncryptionLevel
    data: 4
    type: dword

- name: add Min Encryption Level 2
  ansible.windows.win_regedit:
    path: "{{MinEncryptionLevel}}"
    name: MinEncryptionLevel
    data: 4
    type: dword

- name: add Feature Settings Override
  ansible.windows.win_regedit:
    path: "{{FeatureSettingsOverride}}"
    name: FeatureSettingsOverrideMask
    data: 0x00000003
    type: dword  

- name: add Feature Settings Override
  ansible.windows.win_regedit:
    path: "{{FeatureSettingsOverride}}"
    name: FeatureSettingsOverride
    data: 0x00002048 
    type: dword

- name: add Min Vm Version For Cpu Based Mitigations
  ansible.windows.win_regedit:
    path: "{{MinVmVersionForCpuBasedMitigations}}"
    name: MinVmVersionForCpuBasedMitigations
    data: 1.0 
    type: string    

- name: disable SSL 3.0
  ansible.windows.win_regedit:
    path: "{{Server}}"
    name: Server
    data: 00000000 
    type: dword                

- name: update internet explorer regedit 1
  ansible.windows.win_regedit:
    path: "{{iexplorer}}"
    name: iexplore.exe
    data: 00000001 
    type: dword   

- name: update internet explorer regedit 2
  ansible.windows.win_regedit:
    path: "{{iexplore}}"
    name: iexplore.exe
    data: 00000001 
    type: dword  

- name: update internet explorer regedit 3
  ansible.windows.win_regedit:
    path: "{{internet_exp}}"
    name: iexplore.exe
    data: 00000001 
    type: dword  

- name: update internet explorer regedit 4
  ansible.windows.win_regedit:
    path: "{{intenret}}"
    name: iexplore.exe
    data: 00000001 
    type: dword  

- name: update Diffie_Hellman keys regedit
  ansible.windows.win_regedit:
    path: "{{Diffie_Hellman}}"
    name: Diffie-Hellman
    data: 00000000
    type: dword  

- name: add LM Compatibility Level keys regedit
  ansible.windows.win_regedit:
    path: "{{LMCompatibilityLevel}}"
    name: LMCompatibilityLevel
    data: 5
    type: dword     

- name: add Ciphers keys regedit 1
  ansible.windows.win_regedit:
    path: "{{RC4_40}}"
    name: Enabled
    data: 0
    type: dword      

- name: add Ciphers keys regedit 2
  ansible.windows.win_regedit:
    path: "{{RC4_56}}"
    name: Enabled
    data: 0
    type: dword

- name: disable SSL_SVR_3
  ansible.windows.win_regedit:
    path: "{{SSL_SVR_3}}"
    name: Enabled
    data: 00000000
    type: dword

- name: disable SSL_SVR_3
  ansible.windows.win_regedit:
    path: "{{SSL_SVR_3}}"
    name: DisabledByDefault
    data: 00000001
    type: dword   

- name: disable SSL_CL_3
  ansible.windows.win_regedit:
    path: "{{SSL_CL_3}}"
    name: Enabled
    data: 00000000
    type: dword

- name: disable SSL_CL_3
  ansible.windows.win_regedit:
    path: "{{SSL_CL_3}}"
    name: DisabledByDefault
    data: 00000001
    type: dword      

- name: disable SSL_SVR_2
  ansible.windows.win_regedit:
    path: "{{SSL_SVR_2}}"
    name: Enabled
    data: 00000000
    type: dword

- name: disable SSL_SVR_2
  ansible.windows.win_regedit:
    path: "{{SSL_SVR_2}}"
    name: DisabledByDefault
    data: 00000001
    type: dword   

- name: disable SSL_CL_2
  ansible.windows.win_regedit:
    path: "{{SSL_CL_2}}"
    name: Enabled
    data: 00000000
    type: dword
    
- name: disable SSL_CL_2
  ansible.windows.win_regedit:
    path: "{{SSL_CL_2}}"
    name: DisabledByDefault
    data: 00000001
    type: dword

- name: disable TLS_1_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_1_SVR}}"
    name: Enabled
    data: 00000000
    type: dword

- name: disable TLS_1_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_1_SVR}}"
    name: DisabledByDefault
    data: 00000001
    type: dword   

- name: disable TLS_1_CL
  ansible.windows.win_regedit:
    path: "{{TLS_1_CL}}"
    name: Enabled
    data: 00000000
    type: dword
    
- name: disable TLS_1_CL
  ansible.windows.win_regedit:
    path: "{{TLS_1_CL}}"
    name: DisabledByDefault
    data: 00000001
    type: dword 

- name: enable TLS_2_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_2_SVR}}"
    name: Enabled
    data: 00000001
    type: dword

- name: enable TLS_2_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_2_SVR}}"
    name: DisabledByDefault
    data: 00000000
    type: dword   

- name: enable TLS_2_CL
  ansible.windows.win_regedit:
    path: "{{TLS_2_CL}}"
    name: Enabled
    data: 00000001
    type: dword
    
- name: enable TLS_2_CL
  ansible.windows.win_regedit:
    path: "{{TLS_2_CL}}"
    name: DisabledByDefault
    data: 00000000
    type: dword     

- name: enable TLS_3_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_3_SVR}}"
    name: Enabled
    data: 00000001
    type: dword

- name: enable TLS_3_SVR
  ansible.windows.win_regedit:
    path: "{{TLS_3_SVR}}"
    name: DisabledByDefault
    data: 00000000
    type: dword   

- name: enable TLS_3_CL
  ansible.windows.win_regedit:
    path: "{{TLS_3_CL}}"
    name: Enabled
    data: 00000001
    type: dword
    
- name: enable TLS_3_CL
  ansible.windows.win_regedit:
    path: "{{TLS_3_CL}}"
    name: DisabledByDefault
    data: 00000000
    type: dword

- name: SMB NULL Session Authentication
  ansible.windows.win_regedit:
    path: "{{smb_null}}"
    name: RestrictAnonymous
    data: 1
    type: dword

- name: SMB NULL Session Authentication
  ansible.windows.win_regedit:
    path: "{{smb_1_null}}"
    name: restrictnullsessaccess
    data: 1
    type: dword            